subworkflow cis:
    workdir: "../cis_analysis"
    snakefile: "../cis_analysis/Snakefile"

subworkflow ploidy_compare:
    workdir: "../ploidy_compare"
    snakefile: "../ploidy_compare/Snakefile"

rule all:
    input:
        "poisson_set.pdf", "ext_set.pdf"

rule ext_assocs:
    input:
        rscript = "ext_set.r",
        gene = cis("ext_gene.RData"),
        meta = ploidy_compare("analysis_set.RData"),
        set = "poisson_set.RData"
    output:
        result = "ext_set.RData",
        plot = "ext_set.pdf"
    shell:
        "Rscript {input.rscript}"
            " --meta {input.meta}"
            " --gene {input.gene}"
            " --set {input.set}"
            " --outfile {output.result}"
            " --plotfile {output.plot}"

rule poisson_set:
    input:
        rscript = "poisson_set.r",
        gene = cis("poisson.RData")
    output:
        result = "poisson_set.RData",
        plot = "poisson_set.pdf"
    shell:
        "Rscript {input.rscript}"
            " --infile {input.gene}"
            " --outfile {output.result}"
            " --plotfile {output.plot}"
